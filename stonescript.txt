// General vars
var bardCD = item.GetCooldown("bardiche")

var bestVigorWand

var setupStatus = 0

var shouldHarvest
?loc.begin
    shouldHarvest = false

var offhandMode = "heal"

?setupStatus = 1
    bestVigorWand = item.left.id
    setupStatus = 2

// var button
// func OnPressed()
//     shouldHarvest = !shouldHarvest
//     // Set button text
//     button.text = "Enable Harvesting"
//     ?!shouldHarvest
//         button.text = "Disable Harvesting"

// ?loc.begin
//     button = ui.AddButton()
//     button.y = 0
//     button.text = "Disable Harvesting"
//     button.SetPressed(OnPressed)

?foe = bos
    >State: @foe.state@

func equip_dash()
    equipL sword 
    equipR shield dashing

func offhand_stone()
    ?offhandMode = "heal"
        equipR ouroboros
    :?offhandMode = "xp"
        equipR experience
    :?offhandMode = "speed"
        equipR triskelion

// Default 
equipL triskelion
equipR ouroboros

?pickup.distance < 10
    equipL star

?loc = deadwood
    ?loc.begin
        brew tar
    ?hp < 7
        activate potion

    // Harvesting
    ?harvest.distance < 10 & shouldHarvest
        equip hatchet

    // Fighting
    ?foe.distance <= 16
        // General
        ?foe = mosquito
            equipL vigor wand
            offhand_stone()
        :
            equip bardiche
    
    // Boss
    ?foe = boss & foe.distance < 20
        equip bardiche
        ?foe.distance <= 10 & bardCD <= 0
            activate R

        ?foe = poena
            ?foe.state = 32
                equipL mind

?loc = Caves

    // healing potions are infinite here
    ?loc.begin
        brew tar
    ?hp < 7
        activate potion

    ?foe.distance >= 16 & foe.distance < 20 
        ^& foe ! medium_bat
        equip_dash()

    // Fighting
    ?foe.distance <= 16
        // General
        equipL vigor wand
        offhand_stone()

    // Boss
    ?foe = boss & foe.distance < 20
        equip bardiche
        ?foe.distance <= 10 & bardCD <= 0
            activate R

?loc = Mushroom
    // ?foe.distance >= 16 & foe.distance < 20
    //     equip_dash()

    ?foe.distance <= 16
        ?foe = epic_snail | foe = colossal_snail 
            equip blade
        :
            equipL poison wand
            offhand_stone()

    // Boss
    ?foe = boss & foe.distance < 20
        equipL poison wand *
        equipR poison wand * -@item.left.

?loc = Mine
    ?foe.distance >= 16 & foe.distance < 20
        equip_dash()

    ?foe.distance <= 16
        equipL vigor wand 
        >  best wand @bestVigorWand@
        equipR vigor wand -@bestVigorWand@ 
 
    // Boss
    ?foe = boss & foe.distance < 20
        equipL vigor wand 
        equipR vigor wand -@item.left.id@ 

        // Attack
        ?foe.state = 32
            equipL mind
        // Cooldown - can melee
        :?foe.state = 33
            equip bardiche
            ?foe.distance <= 10 & bardCD <= 0
                activate R

// Setup
?loc.begin
    equipL vigor wand
    setupStatus = 1